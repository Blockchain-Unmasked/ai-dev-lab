<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OCINT - Crypto Theft Victim Report</title>
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%23dc2626'%3E%3Cpath d='M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z'/%3E%3C/svg%3E">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }
        
        .header {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            padding: 1rem 2rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .logo {
            color: white;
            font-size: 1.5rem;
            font-weight: 700;
            text-decoration: none;
        }
        
        .logo:hover {
            color: #fbbf24;
        }
        
        .header-actions {
            display: flex;
            gap: 1rem;
        }
        
        .btn {
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 0.5rem;
            font-weight: 500;
            text-decoration: none;
            cursor: pointer;
            transition: all 0.2s;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .btn-secondary {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.3);
        }
        
        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.3);
        }
        
        .main-content {
            flex: 1;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 2rem;
        }
        
        .chat-container {
            background: white;
            border-radius: 1rem;
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
            width: 100%;
            max-width: 800px;
            height: 600px;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }
        
        .chat-header {
            background: #dc2626;
            color: white;
            padding: 1.5rem;
            text-align: center;
        }
        
        .chat-header h1 {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }
        
        .chat-header p {
            opacity: 0.9;
            font-size: 0.9rem;
        }
        
        .progress-bar {
            background: rgba(255, 255, 255, 0.2);
            height: 4px;
            border-radius: 2px;
            margin-top: 1rem;
            overflow: hidden;
        }
        
        .progress-fill {
            background: #fbbf24;
            height: 100%;
            width: 20%;
            transition: width 0.3s ease;
        }
        
        .chat-messages {
            flex: 1;
            padding: 1.5rem;
            overflow-y: auto;
            background: #f8fafc;
        }
        
        .message {
            margin-bottom: 1rem;
            display: flex;
            align-items: flex-start;
            gap: 0.75rem;
        }
        
        .message.user {
            flex-direction: row-reverse;
        }
        
        .message-avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 0.875rem;
            flex-shrink: 0;
        }
        
        .message.ai .message-avatar {
            background: #dc2626;
            color: white;
        }
        
        .message.user .message-avatar {
            background: #3b82f6;
            color: white;
        }
        
        .message-content {
            max-width: 70%;
            padding: 0.75rem 1rem;
            border-radius: 1rem;
            font-size: 0.9rem;
            line-height: 1.5;
        }
        
        .message.ai .message-content {
            background: white;
            border: 1px solid #e5e7eb;
            color: #374151;
        }
        
        .message.user .message-content {
            background: #3b82f6;
            color: white;
        }
        
        .message-time {
            font-size: 0.75rem;
            opacity: 0.6;
            margin-top: 0.25rem;
        }
        
        .status-message {
            background: #fef3c7;
            border: 1px solid #f59e0b;
            color: #92400e;
            padding: 0.75rem 1rem;
            border-radius: 0.5rem;
            margin: 1rem 0;
            font-size: 0.875rem;
        }
        
        .escalation-message {
            background: #d1fae5;
            border: 1px solid #10b981;
            color: #065f46;
            padding: 1rem;
            border-radius: 0.5rem;
            margin: 1rem 0;
            text-align: center;
        }
        
        .chat-input-container {
            padding: 1.5rem;
            background: white;
            border-top: 1px solid #e5e7eb;
        }
        
        .chat-form {
            display: flex;
            gap: 0.75rem;
        }
        
        .chat-input {
            flex: 1;
            padding: 0.75rem 1rem;
            border: 1px solid #d1d5db;
            border-radius: 0.5rem;
            font-size: 0.9rem;
            outline: none;
            transition: border-color 0.2s;
        }
        
        .chat-input:focus {
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }
        
        .btn-primary {
            background: #dc2626;
            color: white;
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 0.5rem;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        
        .btn-primary:hover {
            background: #b91c1c;
        }
        
        .btn-primary:disabled {
            background: #9ca3af;
            cursor: not-allowed;
        }
        
        .status-panel {
            background: #f3f4f6;
            padding: 1rem 1.5rem;
            border-top: 1px solid #e5e7eb;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.875rem;
        }
        
        .status-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .status-value {
            font-weight: 600;
            color: #dc2626;
        }
        
        .typing-indicator {
            display: none;
            align-items: center;
            gap: 0.5rem;
            color: #6b7280;
            font-size: 0.875rem;
            margin: 0.5rem 0;
        }
        
        .typing-dots {
            display: flex;
            gap: 0.25rem;
        }
        
        .typing-dot {
            width: 6px;
            height: 6px;
            background: #6b7280;
            border-radius: 50%;
            animation: typing 1.4s infinite ease-in-out;
        }
        
        .typing-dot:nth-child(1) { animation-delay: -0.32s; }
        .typing-dot:nth-child(2) { animation-delay: -0.16s; }
        
        @keyframes typing {
            0%, 80%, 100% { transform: scale(0); }
            40% { transform: scale(1); }
        }
        
        .help-panel {
            background: #f8fafc;
            border: 1px solid #e5e7eb;
            border-radius: 0.5rem;
            padding: 1rem;
            margin: 1rem 0;
            font-size: 0.875rem;
        }
        
        .help-panel h4 {
            color: #dc2626;
            margin-bottom: 0.5rem;
        }
        
        .help-panel ul {
            list-style: none;
            padding: 0;
        }
        
        .help-panel li {
            padding: 0.25rem 0;
            color: #6b7280;
        }
        
        @media (max-width: 768px) {
            .main-content {
                padding: 1rem;
            }
            
            .chat-container {
                height: 100vh;
                border-radius: 0;
            }
            
            .header {
                padding: 1rem;
            }
            
            .header-content {
                flex-direction: column;
                gap: 1rem;
            }
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="header-content">
            <a href="#" class="logo">üîç OCINT</a>
            <div class="header-actions">
                <a href="customer-chat.html" class="btn btn-secondary">‚Üê Back to Support</a>
                <button id="new-report" class="btn btn-secondary">New Report</button>
            </div>
        </div>
    </header>

    <main class="main-content">
        <div class="chat-container">
            <div class="chat-header">
                <h1>Crypto Theft Victim Report</h1>
                <p>I'm here to help you create a comprehensive report for our investigators</p>
                <div class="progress-bar">
                    <div class="progress-fill" id="progress-fill"></div>
                </div>
            </div>
            
            <div class="chat-messages" id="chat-messages">
                <div class="message ai">
                    <div class="message-avatar">AI</div>
                    <div class="message-content">
                        <div>Hey there! üëã I'm Alex, and I'm here to help you report what happened with your crypto. I know this is probably really stressful, but we're going to get through this together, okay?</div>
                        <div class="message-time">Just now</div>
                    </div>
                </div>
                <div class="message ai">
                    <div class="message-avatar">AI</div>
                    <div class="message-content">
                        <div>My job is to help you create a detailed report so our investigation team can take a look at your case. It's pretty straightforward - I'll just ask you some questions and we'll get everything documented properly.</div>
                        <div class="message-time">Just now</div>
                    </div>
                </div>
                <div class="message ai">
                    <div class="message-avatar">AI</div>
                    <div class="message-content">
                        <div>Just to be clear, I'm here to help you report the incident and gather the details. I can't actually investigate or trace transactions myself - that's what our human investigators do after we get your report ready.</div>
                        <div class="message-time">Just now</div>
                    </div>
                </div>
                <div class="message ai">
                    <div class="message-avatar">AI</div>
                    <div class="message-content">
                        <div>Sound good? Let's start with getting your contact info so we can stay in touch throughout this process. What's your name and email address? And what's the best phone number to reach you at?</div>
                        <div class="message-time">Just now</div>
                    </div>
                </div>
            </div>
            
            <div class="typing-indicator" id="typing-indicator">
                <span>AI is typing</span>
                <div class="typing-dots">
                    <div class="typing-dot"></div>
                    <div class="typing-dot"></div>
                    <div class="typing-dot"></div>
                </div>
            </div>
            
            <div class="status-panel">
                <div class="status-item">
                    <span>Step:</span>
                    <span class="status-value" id="current-step">1</span>/5
                </div>
                <div class="status-item">
                    <span>Messages:</span>
                    <span class="status-value" id="message-count">0</span>/8
                </div>
                <div class="status-item">
                    <span>Status:</span>
                    <span class="status-value" id="report-status">incomplete</span>
                </div>
                <div class="status-item">
                    <span>Completion:</span>
                    <span class="status-value" id="completion-percent">0%</span>
                </div>
            </div>
            
            <div class="chat-input-container">
                <form id="chat-form" class="chat-form">
                    <input type="text" id="chat-input" class="chat-input" placeholder="Type your response here..." required>
                    <button type="submit" class="btn btn-primary" id="send-btn">Send</button>
                </form>
            </div>
        </div>
    </main>

    <script>
        class OCINTChat {
            constructor() {
                this.currentStep = 1;
                this.messageCount = 0;
                this.reportData = {
                    victim_info: {},
                    incident_details: {},
                    transaction_info: {},
                    evidence: {},
                    timeline: {},
                    status: 'incomplete',
                    message_count: 0
                };
                this.conversationActive = true;
                this.initialize();
            }
            
            initialize() {
                this.bindEvents();
                this.updateStatus();
            }
            
            bindEvents() {
                const form = document.getElementById('chat-form');
                const input = document.getElementById('chat-input');
                const newReportBtn = document.getElementById('new-report');
                
                form.addEventListener('submit', (e) => {
                    e.preventDefault();
                    this.sendMessage();
                });
                
                input.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter' && !e.shiftKey) {
                        e.preventDefault();
                        this.sendMessage();
                    }
                });
                
                newReportBtn.addEventListener('click', () => {
                    this.resetChat();
                });
            }
            
            addMessage(content, type = 'ai', showTime = true) {
                const messagesContainer = document.getElementById('chat-messages');
                const messageDiv = document.createElement('div');
                messageDiv.className = `message ${type}`;
                
                const avatar = document.createElement('div');
                avatar.className = 'message-avatar';
                avatar.textContent = type === 'ai' ? 'AI' : 'You';
                
                const messageContent = document.createElement('div');
                messageContent.className = 'message-content';
                messageContent.innerHTML = content;
                
                if (showTime) {
                    const timeDiv = document.createElement('div');
                    timeDiv.className = 'message-time';
                    timeDiv.textContent = 'Just now';
                    messageContent.appendChild(timeDiv);
                }
                
                messageDiv.appendChild(avatar);
                messageDiv.appendChild(messageContent);
                messagesContainer.appendChild(messageDiv);
                messagesContainer.scrollTop = messagesContainer.scrollHeight;
            }
            
            showTyping() {
                document.getElementById('typing-indicator').style.display = 'flex';
            }
            
            hideTyping() {
                document.getElementById('typing-indicator').style.display = 'none';
            }
            
            updateStatus() {
                document.getElementById('current-step').textContent = this.currentStep;
                document.getElementById('message-count').textContent = this.messageCount;
                document.getElementById('report-status').textContent = this.reportData.status;
                
                // Calculate completion percentage
                let completedFields = 0;
                const totalFields = 10;
                
                if (this.reportData.victim_info && Object.keys(this.reportData.victim_info).length > 0) completedFields += 3;
                if (this.reportData.incident_details && Object.keys(this.reportData.incident_details).length > 0) completedFields += 2;
                if (this.reportData.transaction_info && Object.keys(this.reportData.transaction_info).length > 0) completedFields += 3;
                if (this.reportData.evidence && Object.keys(this.reportData.evidence).length > 0) completedFields += 2;
                
                const completionPercent = Math.round((completedFields / totalFields) * 100);
                document.getElementById('completion-percent').textContent = completionPercent + '%';
                
                // Update progress bar
                document.getElementById('progress-fill').style.width = completionPercent + '%';
                
                // Check for escalation
                const readyForReview = completionPercent >= 80 || this.messageCount >= 8;
                if (readyForReview && this.conversationActive) {
                    this.escalateReport();
                }
            }
            
            extractInformation(message, step) {
                const extracted = {};
                
                if (step === 1) {
                    // Extract victim info
                    const emailMatch = message.match(/\b[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Z|a-z]{2,}\b/);
                    if (emailMatch) extracted.victim_email = emailMatch[0];
                    
                    const phoneMatch = message.match(/(\+?1?[-.\s]?)?\(?([0-9]{3})\)?[-.\s]?([0-9]{3})[-.\s]?([0-9]{4})/);
                    if (phoneMatch) extracted.victim_phone = phoneMatch[0];
                    
                    const nameMatch = message.match(/my name is ([A-Z][a-z]+ [A-Z][a-z]+)/i);
                    if (nameMatch) extracted.victim_name = nameMatch[1];
                } else if (step === 2) {
                    // Extract incident details
                    const dateMatch = message.match(/\d{1,2}\/\d{1,2}\/\d{4}|\d{4}-\d{1,2}-\d{1,2}/);
                    if (dateMatch) extracted.incident_date = dateMatch[0];
                    
                    const timeMatch = message.match(/\d{1,2}:\d{2}\s*(AM|PM|am|pm)?/);
                    if (timeMatch) extracted.incident_time = timeMatch[0];
                    
                    extracted.incident_description = message;
                } else if (step === 3) {
                    // Extract transaction info
                    const cryptoMatch = message.match(/(bitcoin|btc|ethereum|eth|litecoin|ltc|dogecoin|doge)/i);
                    if (cryptoMatch) extracted.crypto_type = cryptoMatch[1].toUpperCase();
                    
                    const amountMatch = message.match(/\$?(\d+(?:,\d{3})*(?:\.\d{2})?)/);
                    if (amountMatch) extracted.amount_stolen = amountMatch[1];
                    
                    const walletMatch = message.match(/[13][a-km-zA-HJ-NP-Z1-9]{25,34}|0x[a-fA-F0-9]{40}/);
                    if (walletMatch) extracted.wallet_addresses = [walletMatch[0]];
                    
                    const txMatch = message.match(/[a-fA-F0-9]{64}/);
                    if (txMatch) extracted.transaction_hashes = [txMatch[0]];
                } else if (step === 4) {
                    // Extract evidence
                    if (message.toLowerCase().includes('screenshot') || message.toLowerCase().includes('image')) {
                        extracted.evidence_files = ['screenshots mentioned'];
                    }
                }
                
                return extracted;
            }
            
            processMessage(message) {
                if (!this.conversationActive) {
                    this.addMessage('‚ùå This conversation is complete. Please start a new report if you need additional assistance.', 'ai');
                    return;
                }
                
                // Extract information based on current step
                const extracted = this.extractInformation(message, this.currentStep);
                
                // Update report data
                if (this.currentStep === 1) {
                    this.reportData.victim_info = { ...this.reportData.victim_info, ...extracted };
                } else if (this.currentStep === 2) {
                    this.reportData.incident_details = { ...this.reportData.incident_details, ...extracted };
                } else if (this.currentStep === 3) {
                    this.reportData.transaction_info = { ...this.reportData.transaction_info, ...extracted };
                } else if (this.currentStep === 4) {
                    this.reportData.evidence = { ...this.reportData.evidence, ...extracted };
                }
                
                this.messageCount++;
                this.reportData.message_count = this.messageCount;
                
                // Show what was extracted
                if (Object.keys(extracted).length > 0) {
                    this.addMessage(`‚úÖ <strong>Information recorded:</strong><br>${JSON.stringify(extracted, null, 2)}`, 'ai');
                }
                
                // Move to next step
                this.currentStep++;
                
                // Check if conversation should continue
                if (this.currentStep > 5 || this.messageCount >= 8) {
                    this.escalateReport();
                } else {
                    // Show next step questions
                    this.showNextStep();
                }
                
                this.updateStatus();
            }
            
            showNextStep() {
                const steps = [
                    {
                        purpose: "Initial greeting and report initiation",
                        questions: [
                            "Hey there! üëã I'm Alex, and I'm here to help you report what happened with your crypto. I know this is probably really stressful, but we're going to get through this together, okay?",
                            "My job is to help you create a detailed report so our investigation team can take a look at your case. It's pretty straightforward - I'll just ask you some questions and we'll get everything documented properly.",
                            "Just to be clear, I'm here to help you report the incident and gather the details. I can't actually investigate or trace transactions myself - that's what our human investigators do after we get your report ready.",
                            "Sound good? Let's start with getting your contact info so we can stay in touch throughout this process. What's your name and email address? And what's the best phone number to reach you at?"
                        ]
                    },
                    {
                        purpose: "Incident details collection",
                        questions: [
                            "Thanks for that info! Now let's talk about what happened. When did you first notice the theft? Do you remember the date and roughly what time it was?",
                            "Can you walk me through what happened? Like, how did you discover that your crypto was gone? Did you get any notifications or did you just notice it when you checked your wallet?"
                        ]
                    },
                    {
                        purpose: "Transaction information",
                        questions: [
                            "Okay, so what kind of crypto are we talking about here? Bitcoin, Ethereum, something else? And do you have a rough idea of how much was taken?",
                            "If you have any wallet addresses that were involved, that would be super helpful. And if you've got any transaction hash IDs or transaction IDs, those are like gold for our investigators.",
                            "Were you using any exchanges or was this all in a personal wallet? If it was an exchange, which one?"
                        ]
                    },
                    {
                        purpose: "Evidence and validation",
                        questions: [
                            "Do you have any screenshots or evidence you can share? Like screenshots of your wallet, transaction records, or any emails or messages related to this?",
                            "Is there anything else about this situation that you think might be important? Sometimes the smallest details can make a big difference in an investigation."
                        ]
                    },
                    {
                        purpose: "Report completion and escalation",
                        questions: [
                            "Perfect! I think I've got everything I need to put together a solid report for you. Our investigation team will review this within 24 hours and someone will reach out to you directly.",
                            "Is there anything else you want to add before I submit this? Sometimes people remember things after we go through everything."
                        ]
                    }
                ];
                
                if (this.currentStep <= steps.length) {
                    const step = steps[this.currentStep - 1];
                    // Show all questions for the current step as separate messages
                    step.questions.forEach((question, index) => {
                        setTimeout(() => {
                            this.addMessage(question);
                        }, index * 1000); // Stagger the messages
                    });
                }
            }
            
            escalateReport() {
                this.conversationActive = false;
                this.reportData.status = 'escalated';
                
                this.addMessage(`
                    <div class="escalation-message">
                        <h3>üéâ Great job! Your report is ready</h3>
                        <p>I've got everything I need and I'm submitting this to our investigation team right now. They'll review it within 24 hours and someone will reach out to you directly.</p>
                        <p><strong>Your Report ID:</strong> OCINT-${Date.now()}</p>
                        <p><strong>What happens next:</strong> A real investigator will contact you to start working on your case. They'll have access to all the details we just collected.</p>
                        <p>Thanks for being so thorough with the information - it really helps our team get started quickly. Hang in there, we're going to do everything we can to help you out! üí™</p>
                    </div>
                `, 'ai', false);
                
                this.updateStatus();
            }
            
            sendMessage() {
                const input = document.getElementById('chat-input');
                const message = input.value.trim();
                
                if (!message) return;
                
                // Add user message
                this.addMessage(message, 'user');
                
                // Show typing indicator
                this.showTyping();
                
                // Simulate AI processing delay
                setTimeout(() => {
                    this.hideTyping();
                    this.processMessage(message);
                }, 1000 + Math.random() * 2000);
                
                // Clear input
                input.value = '';
            }
            
            resetChat() {
                this.currentStep = 1;
                this.messageCount = 0;
                this.reportData = {
                    victim_info: {},
                    incident_details: {},
                    transaction_info: {},
                    evidence: {},
                    timeline: {},
                    status: 'incomplete',
                    message_count: 0
                };
                this.conversationActive = true;
                
                // Clear messages
                document.getElementById('chat-messages').innerHTML = `
                    <div class="message ai">
                        <div class="message-avatar">AI</div>
                        <div class="message-content">
                            <div>Hey there! üëã I'm Alex, and I'm here to help you report what happened with your crypto. I know this is probably really stressful, but we're going to get through this together, okay?</div>
                            <div class="message-time">Just now</div>
                        </div>
                    </div>
                    <div class="message ai">
                        <div class="message-avatar">AI</div>
                        <div class="message-content">
                            <div>My job is to help you create a detailed report so our investigation team can take a look at your case. It's pretty straightforward - I'll just ask you some questions and we'll get everything documented properly.</div>
                            <div class="message-time">Just now</div>
                        </div>
                    </div>
                    <div class="message ai">
                        <div class="message-avatar">AI</div>
                        <div class="message-content">
                            <div>Just to be clear, I'm here to help you report the incident and gather the details. I can't actually investigate or trace transactions myself - that's what our human investigators do after we get your report ready.</div>
                            <div class="message-time">Just now</div>
                        </div>
                    </div>
                    <div class="message ai">
                        <div class="message-avatar">AI</div>
                        <div class="message-content">
                            <div>Sound good? Let's start with getting your contact info so we can stay in touch throughout this process. What's your name and email address? And what's the best phone number to reach you at?</div>
                            <div class="message-time">Just now</div>
                        </div>
                    </div>
                `;
                
                this.updateStatus();
            }
        }
        
        // Initialize the chat when the page loads
        document.addEventListener('DOMContentLoaded', () => {
            new OCINTChat();
        });
    </script>
</body>
</html>
